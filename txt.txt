
if nothing_file:
    for event_label, event_file in event_files.items():
        if event_file:
            print(f"\nChecking {event_label.capitalize()} vs Nothing correlations...")
            common_cols = sorted(list(set(data_structured.get(event_file, {}).keys()) & set(data_structured.get(nothing_file, {}).keys())))
            all_analyzed_channels.update(common_cols)
            print(f"  Found {len(common_cols)} common columns to check.")

            # --- תיקון כאן: הגדר תיאור כללי יותר ל-tqdm ---
            desc_text = f"Comparing {event_label.capitalize()} Cols vs Nothing Cols"
            for col_idx in tqdm(common_cols, desc=desc_text): # שימוש בתיאור הכללי
                sig_event = data_structured[event_file][col_idx]
                sig_nothing = data_structured[nothing_file][col_idx]

                if len(sig_event) < 2 or len(sig_nothing) < 2: continue

                _, _, _, peak_val, _ = calculate_cross_correlation(sig_event, sig_nothing, SAMPLING_RATE)

                if peak_val is not None and abs(peak_val) > PROBLEM_THRESHOLD:
                    # הדפסה עם האינדקס הספציפי עדיין אפשרית כאן
                    print(f"\n  -> PROBLEM identified: Column {col_idx} ({event_label.capitalize()} vs Nothing), Corr = {peak_val:.2f}")
                    problematic_channels.add(col_idx)
